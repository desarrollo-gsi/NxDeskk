<UserControl x:Class="NxDesk.Client.Controls.WindowActions.WindowActionsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:NxDesk.Client.Controls.WindowActions"
             mc:Ignorable="d" >
    <UserControl.Resources>
        <!-- Estilo para el botón principal que abre el menú -->
        <Style x:Key="TriggerButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="30"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="8">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E5E5E5"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Storyboard para mostrar y expandir el panel de acciones -->
        <Storyboard x:Key="ShowActionsAnimation">
            <DoubleAnimation Storyboard.TargetName="ActionsPanel"
                           Storyboard.TargetProperty="Opacity"
                           From="0" To="1" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="ActionsPanel"
                           Storyboard.TargetProperty="(FrameworkElement.RenderTransform).(ScaleTransform.ScaleX)"
                           From="0.1" To="1" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <BackEase EasingMode="EaseOut" Amplitude="0.3"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

        <!-- Storyboard para ocultar y contraer el panel de acciones -->
        <Storyboard x:Key="HideActionsAnimation">
            <DoubleAnimation Storyboard.TargetName="ActionsPanel"
                           Storyboard.TargetProperty="Opacity"
                           To="0" Duration="0:0:0.2"/>
            <DoubleAnimation Storyboard.TargetName="ActionsPanel"
                           Storyboard.TargetProperty="(FrameworkElement.RenderTransform).(ScaleTransform.ScaleX)"
                           To="0.1" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <BackEase EasingMode="EaseIn" Amplitude="0.3"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
    </UserControl.Resources>

    <Grid>
        <!-- Contenedor del menú horizontal (inicialmente colapsado) -->
        <Border x:Name="ActionsPanel"
              Background="White"
              CornerRadius="21"
              Padding="5"
              Effect="{DynamicResource LightShadow}"
              Visibility="Collapsed"
              MouseLeave="ActionsPanel_MouseLeave"
              RenderTransformOrigin="0.5,0.5">
            <Border.RenderTransform>
                <ScaleTransform ScaleX="1"/>
            </Border.RenderTransform>
            <StackPanel Orientation="Horizontal">
                <!-- Botón Minimizar -->
                <Button Style="{StaticResource ActionButtonStyle}" Click="Minimize_Click" ToolTip="Minimizar">
                    <Path Data="M 0 5 H 10" Stroke="#333" StrokeThickness="1.5" Width="12" Height="12" Stretch="Uniform"/>
                </Button>
                <!-- Botón Maximizar/Restaurar -->
                <Button Style="{StaticResource ActionButtonStyle}" Click="Maximize_Click" ToolTip="Maximizar">
                    <Path Data="M 0 0 H 8 V 8 H 0 Z" Stroke="#333" StrokeThickness="1.5" Width="10" Height="10" Stretch="Uniform"/>
                </Button>
                <!-- Separador visual -->
                <Rectangle Width="1" Height="20" Fill="#E0E0E0" Margin="5,0"/>
                <!-- Botón Cerrar Sesión (ícono mejorado) -->
                <Button Style="{StaticResource ActionButtonStyle}" Click="Logout_Click" ToolTip="Cerrar Sesión">
                    <!-- ÍCONO MEJORADO: Puerta con flecha de salida -->
                    <Path Data="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"
                        Fill="#e81123" Width="16" Height="16" Stretch="Uniform"/>
                </Button>
            </StackPanel>
        </Border>

        <!-- Botón principal que abre el menú -->
        <Button x:Name="MainButton" Click="MainButton_Click" Style="{StaticResource TriggerButtonStyle}" ToolTip="Opciones de ventana">
            <!-- Icono de tres puntos (vertical) -->
            <Path Data="M12,8c1.1,0,2-0.9,2-2s-0.9-2-2-2s-2,0.9-2,2S10.9,8,12,8z M12,10c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S13.1,10,12,10z M12,16c-1.1,0-2,0.9-2,2s0.9,2,2,2s2-0.9,2-2S13.1,16,12,16z"
                Fill="#555"
                Stretch="Uniform"
                Width="16" Height="16"/>
        </Button>
    </Grid>
</UserControl>
